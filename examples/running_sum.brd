# TODO: how to do super?

set RunningSum = @Object subclass
  # special syntax for constructor
  constructor()
    set this.sum = 0
    set this.sum_sq = 0
    set this.n = 0
    this # make sure to return this!!
  end

  set update = func(num)
    set this.sum = this.sum + num
    set this.sum_sq = this.sum_sq + num^2
    set this.n = this.n + 1
    unit
  end

  set mean = func() this.sum / this.n end

  set stdev = func()
    ((this.sum_sq / this.n) - ((this.sum / this.n) ^ 2)) ^ 0.5
  end
end

set x = RunningSum()
x::update(50)
x::update(100)
@writeln("mean: ", x::mean())
@writeln("stdev: ", x::stdev())
@writeln("sum: ", x.sum)

@writeln()

set y = RunningSum subclass
  constructor()
    set this.sum = 0
    set this.sum_sq = 0
    set this.n = 0
    this
  end

  set debug = func()
    @writeln("sum: ", this.sum)
    @writeln("sum_sq: ", this.sum_sq)
    @writeln("num: ", this.n)
  end
end()

y::update(50)
y::update(100)
y::debug()
@writeln("mean: ", y::mean())
@writeln("stdev: ", y::stdev())
